name: RestAssured Tesults

on:
  workflow_dispatch:

jobs:
  run-restassured-tests:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¦ Checkout cÃ³digo
        uses: actions/checkout@v4

      - name: â˜• Configurar Java 21
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '21'

      # Opcional, mas limpa o ambiente
      - name: ğŸ”§ Instalar dependÃªncias (sem rodar testes)
        run: mvn clean install -DskipTests

      # ğŸ§ª CRÃTICO: Roda os testes E INJETA o token para o Tesults
      - name: ğŸ§ª Rodar testes JUnit (Tesults Upload)
        run: mvn test -DtesultsTarget=${{ secrets.TESULTS_TOKEN }}
        # O listener do tesults-junit5 detecta -DtesultsTarget e faz o upload automÃ¡tico aqui.

      # ğŸ“¤ Etapa Antiga de CURL REMOVIDA
      
      # ğŸ’¾ Mantido: Upload de relatÃ³rios JUnit (Surefire) como Artefato
      - name: ğŸ’¾ Upload de relatÃ³rios JUnit
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: surefire-reports
          path: target/surefire-reports
