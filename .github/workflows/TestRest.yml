name: RestAssured Tesults

on:
  workflow_dispatch:

jobs:
  run-restassured-tests:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¦ Checkout cÃ³digo
        uses: actions/checkout@v4

      - name: â˜• Configurar Java 21
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '21'

      - name: ğŸ”§ Instalar dependÃªncias (sem rodar testes)
        run: mvn clean install -DskipTests

      - name: ğŸ§ª Rodar testes JUnit (RestAssured)
        run: mvn test

      # ğŸ‘‡ SÃ³ roda se quiser enviar os resultados pro Tesults
      - name: ğŸ“¤ Upload para Tesults
        if: always()
        env:
          TESULTS_TOKEN: ${{ secrets.TESULTS_TOKEN }}
        run: |
          echo "ğŸ“¡ Enviando resultados para Tesults..."
          curl -X POST \
               -H "Content-Type: application/json" \
               -d "{\"target\": {\"token\": \"${TESULTS_TOKEN}\"}}" \
               https://www.tesults.com/results/api

      - name: ğŸ“¤ Upload de relatÃ³rios JUnit
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: surefire-reports
          path: target/surefire-reports
